{% extends 'base.html.twig' %}

{% block title %}Clients{% endblock %}

{% block body %}
    {% include 'layout/navbar.html.twig' %}
        <div class="client-month container mb-100 ">
            <h1>Clients {{titleMonth}} {{year}} <i class="fa fa-whatsapp" aria-hidden="true"></i>
            </h1>
            <a  class="btn btn-outline-dark" href="{{ path('client_index',{'month': month, 'year':year, 'method' : 'precedent' }) }}"><img class="precedent" width='25px' src="{{asset('./images/icon-precedent.png')}}"/></a>
            <a  class="btn btn-outline-dark float-end" href="{{ path('client_index',{'month': month, 'year':year, 'method' : 'suivant' }) }}"><img class="suivant" width='25px' src="{{asset('./images/icon-suivant.png')}}"/></a>
            <table class="table">
                <thead>
                    <tr class='table_head'>
                        <th class="h-date-c ">Date</th>
                        <th class="h-civil-c">Civilité</th>
                        <th class='h-nom-c' >Nom</th>
                        <th class='h-prenom-c'>Prenom</th>
                        <th class='h-telephone-c' >Télephone</th>
                        <th class='h-maque-c' >Marque</th>
                        <th class='h-modele-c' >Modele</th>
                        <th class='h-chargeur-c'>Chargeur</th>
                        <th class='h-etat-c' >Etat</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
            
                {% for client in clients | sort((a, b) => b.date <=> a.date) %}
                    {% set counter = ( counter | default(0) ) + 1 %}
                    {% if counter % 2 %}
                        <tr class='ligne_client tr_no_color select'>
                    {% else %}
                    {#client_livrate#}
                        <tr class='ligne_client tr_color select'>
                    {% endif %}
                        <td class="td-date h-date-c">{{ client.date|date('d M Y H:i')|format_datetime('medium','short',locale='fr')}}</td>
                        <td  class='h-civil-c' >{{ client.personne }}</td>
                        <td class='h-nom-c' >{{ client.nom }}</td>
                        <td class='h-prenom-c'>{{ client.prenom }}</td>
                        <td class='h-telephone-c'>{{ client.tel }} </td>
                        <td class='h-maque-c'>{{ client.appareil.marque }} </td>
                        <td  class='h-modele-c' >{{ client.appareil.modele }} </td>
                        {% if client.appareil.chargeur == 1 %}
                        <td> <img  class='check' src="{{asset('./images/check.png')}}" width="40px" /></td>
                        {% else %}
                        <td class='h-chargeur-c' >  <img  class='cross' src="{{asset('./images/cross.png')}}" width="40px" /></td>
                        {% endif %}
                        {% if client.appareil.editeur.etat.statut is defined %}
                            <td class='statutAppareilAll h-etat-c' > 
                                <span class="badge" id='change-statut{{client.id}}' style="font-size:16px"> {{ client.appareil.editeur.etat.statut}} </span>
                            </td>
                        {% else %}
                        <td>  </td>
                        {% endif %}
                        <td class="inline-button mw-250">
                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" title="Afficher les informations client"  data-bs-target="#cardClient{{client.id}}">
                                <i  width='25%' class="bi bi-person-bounding-box show-info-client"></i>
                            </button>
                            <a title="Modifier les informations client" class="btn btn-secondary"href="{{ path('client_edit', {'id': client.id}) }}"><img class="edit" width='25px' src="{{asset('./images/icon-edit.png')}}"/></a>
                            {{ include('client/_delete_form.html.twig') }}
                        </td>
                    </tr>
                        {{ include('client/modal/modal.html.twig') }}
                {% else %}
                    <tr >
                        <td colspan="12" class='white'>En attente de clients...</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <a  class="btn btn-success btn-lg" href="{{ path('client_new') }}"><img class="delete" width='28px' src="{{asset('./images/icon-add.png')}}"/></a>
        </div>

    
    {% include 'layout/footer.html.twig' %}
{% endblock %}
